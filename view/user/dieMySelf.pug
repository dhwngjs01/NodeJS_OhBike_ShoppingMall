doctype html
html
	head
		include ../head.pug
		style.
			.row {
				display:flex;
				flex-wrap:wrap;
			}

			.row > *{
				flex-shrink:0;
				width:100%;
				max-width:100%;

				padding-right:10px;
				padding-left:10px;
			}

			.justify-content-center {
				justify-content:center!important;
			}

			.w-75 {
				width:75%;
			}

			.mx-auto {
				margin-left:auto;
				margin-right:auto;
			}

			.col-lg-12 {
				flex:0 0 100%;
				max-width:100%;
			}

			.col-lg-6 {
				flex:0 0 50%;
				max-width:50%;
			}

			.col-lg-2 {
				flex:0 0 16.66667%;
				max-width:16.66667%;
				padding-left:0;
			}

			.col-lg-auto {
				flex:0 0 auto;
				width:auto;
				max-width:100%;
			}

			.text-center {
				text-align:center;
			}

			.mb-3 {
				margin-bottom:1rem;
			}

			.form-label {
				margin-bottom:0.5rem;
			}

			.form-control {
				display:block;
				width:100%;
				height:calc(1.5em + 0.75rem + 2px);
				padding:0.375rem 0.75rem;
				font-size:1rem;
				font-weight:400;
				line-height:1.5;
				color:#495057;
				background-color:#fff;
				background-clip:padding-box;
				border:1px solid #ced4da;
				border-radius:0.25rem;
				transition:border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;
			}

			.form-control:focus {
				color:#495057;
				background-color:#fff;
				border-color:#80bdff;
				outline:0;
				box-shadow:0 0 0 0.2rem rgba(0,123,255,.25);
			}

			.btn {
				display:inline-block;
				font-weight:400;
				color:#212529;
				text-align:center;
				vertical-align:middle;
				-webkit-user-select:none;
				-moz-user-select:none;
				-ms-user-select:none;
				user-select:none;
				background-color:transparent;
				border:1px solid transparent;
				padding:0.375rem 0.75rem;
				font-size:1rem;
				line-height:1.5;
				border-radius:0.25rem;
				transition:color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;
			}

			.btn:hover {
				color:#212529;
				text-decoration:none;
			}

			.btn:focus {
				outline:0;
				box-shadow:0 0 0 0.2rem rgba(0,123,255,.25);
			}

			.btn:disabled {
				opacity:0.65;
			}

			.btn-primary {
				color:#fff;
				background-color:#007bff;
				border-color:#007bff;
			}

			.btn-primary:hover {
				color:#fff;
				background-color:#0069d9;
				border-color:#0062cc;
			}

			.btn-primary:focus {
				color:#fff;
				background-color:#0069d9;
				border-color:#0062cc;
				box-shadow:0 0 0 0.2rem rgba(38,143,255,.5);
			}

			.btn-primary:disabled {
				color:#fff;
				background-color:#007bff;
				border-color:#007bff;
			}

			.btn-secondary {
				color:#fff;
				background-color:#6c757d;
				border-color:#6c757d;
			}

			.btn-secondary:hover {
				color:#fff;
				background-color:#5a6268;
				border-color:#545b62;
			}

			.btn-secondary:focus {
				color:#fff;
				background-color:#5a6268;
				border-color:#545b62;
				box-shadow:0 0 0 0.2rem rgba(130,138,145,.5);
			}

			.btn-secondary:disabled {
				color:#fff;
				background-color:#6c757d;
				border-color:#6c757d;
			}
	body
		#wrap
			include ../header.pug
			#contents
				.wrap
					#myPage
						.left
							h3.title 마이페이지
							
							p.user_name #{session.user_name} 님
							
							.sideMenu
								.sideMenuItem
									p 쇼핑정보
									ul
										li
											a(href="/user/orderInfo") - 주문/배송조회
										li
											a(href="/user/basket") - 장바구니
								.sideMenuItem
									p 회원정보
									ul
										li
											a(href="/user/modify") - 회원정보수정
										li
											a(href="/user/dieMySelf") - 회원탈퇴

						.right
							#dieMySelf
								form#dieMySelfForm(action="/user/dieMySelf" method="delete")
									.row.w-75.mx-auto
										.col-lg-12
											.mb-3
												h3 회원탈퇴
											.mb-3
												span 회원탈퇴를 하시면 모든 정보가 삭제되며, 복구가 불가능합니다.
											.mb-3
												span 정말로 탈퇴하시겠습니까?
											.mb-3
												span 비밀번호를 입력해주세요.
											.mb-3
												input.form-control(type="password" name="user_pw" placeholder="비밀번호를 입력해주세요.")
											
											.row.justify-content-center
												.col-lg-auto
													.mb-3
														button.btn.btn-primary.cursor-pointer(type="submit") 탈퇴하기
												.col-lg-auto
													.mb-3
														button.btn.btn-secondary.cursor-pointer(type="button" onclick="location.href='/user/modify'") 취소

			include ../footer.pug
		include ../script.pug
		script.
			$(document).ready(function() {
				$("#dieMySelfForm").submit(function(e) {
					e.preventDefault();

					if($("input[name='user_pw']").val() == "") {
						alert("비밀번호를 입력해주세요.");
						$("input[name='user_pw']").focus();
						return false;
					}

					if(!confirm("정말로 탈퇴하시겠습니까?")) {
						return false;
					}

					$.ajax({
						url: "/user/dieMySelf",
						type: "delete",
						data: {
							user_pw: $("input[name='user_pw']").val()
						},
						success: function(data) {
							if(data.message){
								alert(data.message);
							}

							if(data.success) {
								location.href = "/";
							}

							if(data.password_invalid){
								$("input[name='user_pw']").focus();
							}
						}
					});
				});
			});